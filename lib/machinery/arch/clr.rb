require 'machinery/arch'

module Machinery::Architecture

  ##
  # Common Language Runtime (CLR, or CIL aka MSIL) opcodes.
  #
  # @see http://www.ecma-international.org/publications/standards/Ecma-335.htm
  # @see http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes_members.aspx
  module CLR extend StackMachine

    module Opcodes
      NOP                  = 0x00 # 000
      BREAK                = 0x01 # 001
      LDARG_0              = 0x02 # 002
      LDARG_1              = 0x03 # 003
      LDARG_2              = 0x04 # 004
      LDARG_3              = 0x05 # 005
      LDLOC_0              = 0x06 # 006
      LDLOC_1              = 0x07 # 007
      LDLOC_2              = 0x08 # 008
      LDLOC_3              = 0x09 # 009
      STLOC_0              = 0x0a # 010
      STLOC_1              = 0x0b # 011
      STLOC_2              = 0x0c # 012
      STLOC_3              = 0x0d # 013
      LDARG_S              = 0x0e # 014
      LDARGA_S             = 0x0f # 015
      STARG_S              = 0x10 # 016
      LDLOC_S              = 0x11 # 017
      LDLOCA_S             = 0x12 # 018
      STLOC_S              = 0x13 # 019
      LDNULL               = 0x14 # 020
      LDC_I4_M1            = 0x15 # 021
      LDC_I4_0             = 0x16 # 022
      LDC_I4_1             = 0x17 # 023
      LDC_I4_2             = 0x18 # 024
      LDC_I4_3             = 0x19 # 025
      LDC_I4_4             = 0x1a # 026
      LDC_I4_5             = 0x1b # 027
      LDC_I4_6             = 0x1c # 028
      LDC_I4_7             = 0x1d # 029
      LDC_I4_8             = 0x1e # 030
      LDC_I4_S             = 0x1f # 031
      LDC_I4               = 0x20 # 032
      LDC_I8               = 0x21 # 033
      LDC_R4               = 0x22 # 034
      LDC_R8               = 0x23 # 035
      DUP                  = 0x25 # 037
      POP                  = 0x26 # 038
      JMP                  = 0x27 # 039
      CALL                 = 0x28 # 040
      CALLI                = 0x29 # 041
      RET                  = 0x2a # 042
      BR_S                 = 0x2b # 043
      BRFALSE_S            = 0x2c # 044
      BRTRUE_S             = 0x2d # 045
      BEQ_S                = 0x2e # 046
      BGE_S                = 0x2f # 047
      BGT_S                = 0x30 # 048
      BLE_S                = 0x31 # 049
      BLT_S                = 0x32 # 050
      BNE_UN_S             = 0x33 # 051
      BGE_UN_S             = 0x34 # 052
      BGT_UN_S             = 0x35 # 053
      BLE_UN_S             = 0x36 # 054
      BLT_UN_S             = 0x37 # 055
      BR                   = 0x38 # 056
      BRFALSE              = 0x39 # 057
      BRTRUE               = 0x3a # 058
      BEQ                  = 0x3b # 059
      BGE                  = 0x3c # 060
      BGT                  = 0x3d # 061
      BLE                  = 0x3e # 062
      BLT                  = 0x3f # 063
      BNE_UN               = 0x40 # 064
      BGE_UN               = 0x41 # 065
      BGT_UN               = 0x42 # 066
      BLE_UN               = 0x43 # 067
      BLT_UN               = 0x44 # 068
      SWITCH               = 0x45 # 069
      LDIND_I1             = 0x46 # 070
      LDIND_U1             = 0x47 # 071
      LDIND_I2             = 0x48 # 072
      LDIND_U2             = 0x49 # 073
      LDIND_I4             = 0x4a # 074
      LDIND_U4             = 0x4b # 075
      LDIND_I8             = 0x4c # 076
      LDIND_I              = 0x4d # 077
      LDIND_R4             = 0x4e # 078
      LDIND_R8             = 0x4f # 079
      LDIND_REF            = 0x50 # 080
      STIND_REF            = 0x51 # 081
      STIND_I1             = 0x52 # 082
      STIND_I2             = 0x53 # 083
      STIND_I4             = 0x54 # 084
      STIND_I8             = 0x55 # 085
      STIND_R4             = 0x56 # 086
      STIND_R8             = 0x57 # 087
      ADD                  = 0x58 # 088
      SUB                  = 0x59 # 089
      MUL                  = 0x5a # 090
      DIV                  = 0x5b # 091
      DIV_UN               = 0x5c # 092
      REM                  = 0x5d # 093
      REM_UN               = 0x5e # 094
      AND                  = 0x5f # 095
      OR                   = 0x60 # 096
      XOR                  = 0x61 # 097
      SHL                  = 0x62 # 098
      SHR                  = 0x63 # 099
      SHR_UN               = 0x64 # 100
      NEG                  = 0x65 # 101
      NOT                  = 0x66 # 102
      CONV_I1              = 0x67 # 103
      CONV_I2              = 0x68 # 104
      CONV_I4              = 0x69 # 105
      CONV_I8              = 0x6a # 106
      CONV_R4              = 0x6b # 107
      CONV_R8              = 0x6c # 108
      CONV_U4              = 0x6d # 109
      CONV_U8              = 0x6e # 110
      CALLVIRT             = 0x6f # 111
      CPOBJ                = 0x70 # 112
      LDOBJ                = 0x71 # 113
      LDSTR                = 0x72 # 114
      NEWOBJ               = 0x73 # 115
      CASTCLASS            = 0x74 # 116
      ISINST               = 0x75 # 117
      CONV_R_UN            = 0x76 # 118
      UNBOX                = 0x79 # 121
      THROW                = 0x7a # 122
      LDFLD                = 0x7b # 123
      LDFLDA               = 0x7c # 124
      STFLD                = 0x7d # 125
      LDSFLD               = 0x7e # 126
      LDSFLDA              = 0x7f # 127
      STSFLD               = 0x80 # 128
      STOBJ                = 0x81 # 129
      CONV_OVF_I1_UN       = 0x82 # 130
      CONV_OVF_I2_UN       = 0x83 # 131
      CONV_OVF_I4_UN       = 0x84 # 132
      CONV_OVF_I8_UN       = 0x85 # 133
      CONV_OVF_U1_UN       = 0x86 # 134
      CONV_OVF_U2_UN       = 0x87 # 135
      CONV_OVF_U4_UN       = 0x88 # 136
      CONV_OVF_U8_UN       = 0x89 # 137
      CONV_OVF_I_UN        = 0x8a # 138
      CONV_OVF_U_UN        = 0x8b # 139
      BOX                  = 0x8c # 140
      NEWARR               = 0x8d # 141
      LDLEN                = 0x8e # 142
      LDELEMA              = 0x8f # 143
      LDELEM_I1            = 0x90 # 144
      LDELEM_U1            = 0x91 # 145
      LDELEM_I2            = 0x92 # 146
      LDELEM_U2            = 0x93 # 147
      LDELEM_I4            = 0x94 # 148
      LDELEM_U4            = 0x95 # 149
      LDELEM_I8            = 0x96 # 150
      LDELEM_I             = 0x97 # 151
      LDELEM_R4            = 0x98 # 152
      LDELEM_R8            = 0x99 # 153
      LDELEM_REF           = 0x9a # 154
      STELEM_I             = 0x9b # 155
      STELEM_I1            = 0x9c # 156
      STELEM_I2            = 0x9d # 157
      STELEM_I4            = 0x9e # 158
      STELEM_I8            = 0x9f # 159
      STELEM_R4            = 0xa0 # 160
      STELEM_R8            = 0xa1 # 161
      STELEM_REF           = 0xa2 # 162
      LDELEM               = 0xa3 # 163
      STELEM               = 0xa4 # 164
      UNBOX_ANY            = 0xa5 # 165
      CONV_OVF_I1          = 0xb3 # 179
      CONV_OVF_U1          = 0xb4 # 180
      CONV_OVF_I2          = 0xb5 # 181
      CONV_OVF_U2          = 0xb6 # 182
      CONV_OVF_I4          = 0xb7 # 183
      CONV_OVF_U4          = 0xb8 # 184
      CONV_OVF_I8          = 0xb9 # 185
      CONV_OVF_U8          = 0xba # 186
      REFANYVAL            = 0xc2 # 194
      CKFINITE             = 0xc3 # 195
      MKREFANY             = 0xc6 # 198
      LDTOKEN              = 0xd0 # 208
      CONV_U2              = 0xd1 # 209
      CONV_U1              = 0xd2 # 210
      CONV_I               = 0xd3 # 211
      CONV_OVF_I           = 0xd4 # 212
      CONV_OVF_U           = 0xd5 # 213
      ADD_OVF              = 0xd6 # 214
      ADD_OVF_UN           = 0xd7 # 215
      MUL_OVF              = 0xd8 # 216
      MUL_OVF_UN           = 0xd9 # 217
      SUB_OVF              = 0xda # 218
      SUB_OVF_UN           = 0xdb # 219
      ENDFINALLY           = 0xdc # 220
      LEAVE                = 0xdd # 221
      LEAVE_S              = 0xde # 222
      STIND_I              = 0xdf # 223
      CONV_U               = 0xe0 # 224
      PREFIX7              = 0xf8 # 248
      PREFIX6              = 0xf9 # 249
      PREFIX5              = 0xfa # 250
      PREFIX4              = 0xfb # 251
      PREFIX3              = 0xfc # 252
      PREFIX2              = 0xfd # 253
      PREFIX1              = 0xfe # 254
      PREFIXREF            = 0xff # 255
      ARGLIST              = 0xfe00
      CEQ                  = 0xfe01
      CGT                  = 0xfe02
      CGT_UN               = 0xfe03
      CLT                  = 0xfe04
      CLT_UN               = 0xfe05
      LDFTN                = 0xfe06
      LDVIRTFTN            = 0xfe07
      LDARG                = 0xfe09
      LDARGA               = 0xfe0a
      STARG                = 0xfe0b
      LDLOC                = 0xfe0c
      LDLOCA               = 0xfe0d
      STLOC                = 0xfe0e
      LOCALLOC             = 0xfe0f
      ENDFILTER            = 0xfe11
      UNALIGNED            = 0xfe12
      VOLATILE             = 0xfe13
      TAIL                 = 0xfe14
      INITOBJ              = 0xfe15
      CONSTRAINED          = 0xfe16
      CPBLK                = 0xfe17
      INITBLK              = 0xfe18
      RETHROW              = 0xfe1a
      SIZEOF               = 0xfe1c
      REFANYTYPE           = 0xfe1d
      READONLY             = 0xfe1e
    end
  end

end
